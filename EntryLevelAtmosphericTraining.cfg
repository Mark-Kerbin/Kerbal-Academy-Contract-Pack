 CONTRACT_TYPE
    { //Define Contract Information / Displayed Information
        name = EntryLevelAtmosphericPilotTraining
        title = Kerbal Academy: Entry Level Atmospheric Piloting Course
		group = KerbalAcademy
        description = One of the new recruits, @/trainee , has been selected to take the Entry Level Pilot Training Course to improve their abilities. 
		genericDescription = Pliots must complete the lower level course to improve their skills.
        synopsis = Complete the training course with @/trainee .
        completedMessage = Congratulations @/trainee 
        agent = Kerbal Academy
		notes = The parameters must be completed in order.
        minExpiry = 1
        maxExpiry = 7
		maxSimultaneous = 1
        cancellable = true
        declinable = true
        prestige = Trivial
        targetBody = HomeWorld()
        rewardScience = 0.0
        rewardReputation = 0.0
        rewardFunds = 0
        failureReputation = 0
        failureFunds = 0
        advanceFunds = @/trainingCost
		
		//Find Kerbal 
		DATA
		{ 
			type = Kerbal
			uniquenessCheck = CONTRACT_ACTIVE
			trainee = AllKerbals().Where(m => m.ExperienceTrait() == Pilot && m.Type() == Crew && m.RosterStatus() == Available && m.ExperienceLevel() <=2).Random()
			title = Must have a Pilot below Level 2 available in the roster. 
		}
		
		//Set XP rewards
		DATA
		{
			type = double
			expAward = (@/mentor.ExperienceLevel() - @/trainee.ExperienceLevel())*1.5  
			baseMentorlevel = @/trainee.ExperienceLevel()+1
		}
		
		DATA
		{
			type = List<Kerbal>
			requiredValue = false
			aliveKerbals = AllKerbals().Where(a => a.RosterStatus() == Available || a.RosterStatus() == Assigned)
			mentorList = @aliveKerbals.Where(m => m.ExperienceTrait() == Pilot && m.Type() == Crew && m.ExperienceLevel() > @baseMentorlevel)
		}
		
		// Find Mentor
		DATA
		{	
			type = Kerbal
			uniquenessCheck = CONTRACT_ACTIVE
			mentor = AllKerbals().Where(m => m.ExperienceTrait() == Pilot && m.Type() == Crew && m.RosterStatus() == Available && m.ExperienceLevel()>= @baseMentorlevel).Random()
			title = Must have a Pilot at least one level above that of the trainee available in the roster. 
		}
		
		//Set Cost
		DATA
		{ 
			type = double
			trainingCost = -((5000*@expAward)+15000) 
		}	
		
		//Check that everyone is onboard for launch
		PARAMETER
		{
			name = Inital Crew Check
			type = All
			title = Have @/trainee and @/mentor on board before flight.
			disableOnStateChange = true
			
			//Parameters checking each crew memeber 
			PARAMETER
			{
				name = Check Trainee
				type = HasCrew
				kerbal = @/trainee
				title = Have @/trainee on board.
				disableOnStateChange = false
			}
			
			PARAMETER
			{
				name = Check Mentor
				type = HasCrew
				kerbal = @/mentor
				title = Have @/mentor on board.
				disableOnStateChange = false
			}
			
			//Are you landed tho?
			PARAMETER
			{
				name = Check Landed
				type = ReachState
				hidden = true
				targetBody = HomeWorld()
				situation = PRELAUNCH
				disableOnStateChange = false
			}
		}
		
		BEHAVIOUR
		{
			name = WaypointGenerator
			type = WaypointGenerator
			
			PQS_CITY
			{
				name = KSC
				hidden = true
				parameter = Intial Crew Check
				pqsCity = KSC
			}
			
			RANDOM_WAYPOINT_NEAR
			{
				name = Training Course Starting Point
				icon = custom
				altitude = Random(250, 4000)
				minDistance = 5000.0
				maxDistance = 8000.0
				nearIndex = 0
				chained = true
			}
			
			RANDOM_WAYPOINT_NEAR
			{
				name = Training Course 2nd Marker
				icon = custom
				parameter = WP1
				altitude = Random(250, 4000)
				minDistance = 5000.0
				maxDistance = 8000.0
				nearIndex = 1
				chained = true
			}
			
			RANDOM_WAYPOINT_NEAR
			{
				name = Training Course 3rd Marker
				icon = custom
				parameter = WP2
				altitude = Random(250, 4000)
				minDistance = 5000.0
				maxDistance = 8000.0
				nearIndex = 2
				chained = true
			}
			
			RANDOM_WAYPOINT_NEAR
			{
				name = Training Course 4th Marker
				icon = custom
				parameter = WP3
				altitude = Random(250, 4000)
				minDistance = 5000.0
				maxDistance = 8000.0
				nearIndex = 3
				chained = true
			}
			
			RANDOM_WAYPOINT_NEAR
			{
				name = Final Training Course Marker
				icon = custom
				parameter = WP4
				altitude = Random(250, 4000)
				minDistance = 5000.0
				maxDistance = 8000.0
				nearIndex = 4
				chained = true
			}
		}
		
		PARAMETER
		{
			name = Fly Course
			type = All
			title = Successfully Fly Through All Course Markers
			completeInSequence = true
			
			PARAMETER
			{
				name = WP1
				type = VisitWaypoint
				title = Fly Through The Starting Waypoint
				index = 1
				hideOnCompletion = true
				disableOnStateChange = true
				completeInSequence = true
			}

			PARAMETER
			{
				name = WP2
				type = VisitWaypoint
				title = Fly Through The Second Waypoint
				index = 2
				hideOnCompletion = true
				disableOnStateChange = true
				completeInSequence = true
			}

			PARAMETER
			{
				name = WP3
				type = VisitWaypoint
				title = Fly Through The Third Waypoint
				index = 3
				hideOnCompletion = true
				disableOnStateChange = true
				completeInSequence = true
			}

			PARAMETER
			{
				name = WP4
				type = VisitWaypoint
				title = Fly Through The Forth Waypoint
				index = 4
				hideOnCompletion = true
				disableOnStateChange = true
				completeInSequence = true
			}
			
			PARAMETER
			{
				name = WP5
				type = VisitWaypoint
				title = Fly Through The Final Waypoint
				index = 5
				hideOnCompletion = true
				disableOnStateChange = true
				completeInSequence = true
			}
		}
		
		PARAMETER
		{
			name = landedSafe
			type = All
			title = Land Safely On The KSC Runway
			disableOnStateChange = false
			completeInSequence = true
			
			PARAMETER
			{
				name = onRunway
				type = ReachState
				title = Land
				completeInSequence = true				
				targetBody = HomeWorld()
				biome = Runway
				situation = LANDED
			}
			
			//Final Crew Check
			PARAMETER
			{
				name = Final Crew Check
				type = All
				title = Have @/trainee and @/mentor on board on landing.
				completeInSequence = true
				disableOnStateChange = true
			
				//Parameters checking each crew member 
				PARAMETER
				{
					name = Check Trainee
					type = HasCrew
					kerbal = @/trainee
					title = Have @/trainee on board.
					completeInSequence = true
					disableOnStateChange = true
				}
			
				PARAMETER
				{
					name = Check Mentor
					type = HasCrew
					kerbal = @/mentor
					title = Have @/mentor on board.
					completeInSequence = true
					disableOnStateChange = true
				}
			}
		}
		
		BEHAVIOUR
		{
			name = AwardExperience
			type = AwardExperience
			parameter = landedSafe
			kerbal = @/trainee
			experience = @/expAward
		}	
	}